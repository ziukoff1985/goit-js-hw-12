{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios'; // Імпортуємо бібліотеку Axios\n\nconst API_KEY = '46843956-48321f6890b82a65cca7319ef';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1) {\n  const searchParams = new URLSearchParams({\n    key: API_KEY, // Ключ API для автентифікації.\n    q: query, // Запит на пошук, введений користувачем.\n    image_type: 'photo', // Тип зображень ('photo').\n    orientation: 'horizontal', // Орієнтація зображень - горизонтальна.\n    safesearch: true, // Безпечний пошук.\n    page: page,\n    per_page: 15,\n  });\n\n  const url = `${BASE_URL}?${searchParams}`;\n\n  try {\n    // Виконуємо запит за допомогою axios.get\n    const response = await axios.get(url);\n\n    return response.data; // Повертаємо дані у випадку успіху\n  } catch (error) {\n    // Обробка помилок\n    iziToast.error({\n      title: 'Error', // Заголовок повідомлення.\n      message: 'Failed to fetch images. Please try again later.', // Текст повідомлення для користувача.\n      position: 'topRight', // Розташування повідомлення.\n    });\n    console.error('There was a problem with the fetch operation:', error);\n    throw error; // Рекомендується повторно кинути помилку, якщо є логіка для обробки її в іншій частині коду\n  }\n}\n","'use strict';\n\nconst gallery = document.querySelector('.gallery');\n\nexport function createMarkup(arrImages) {\n  const markup = arrImages\n    .map(image => {\n      return `<li class=\"gallery-item\">\n\t  <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n\t\t<img \n\t\t\tclass=\"gallery-image\" \n\t\t\tsrc=\"${image.webformatURL}\" \n\t\t\talt=\"${image.tags}\" \n\t\t\t/>\n        <div class=\"gallery-info\">\n        <p class=\"gallery-likes\"><span>Likes:</span> ${image.likes}</p>\n        <p class=\"gallery-views\"><span>Views:</span> ${image.views}</p>\n        <p class=\"gallery-comments\"><span>Comments:</span> ${image.comments}</p>\n        <p class=\"gallery-downloads\"><span>Downloads:</span> ${image.downloads}</p>\n      </div>    \n\t  </a>\n    </li>\n    `;\n    })\n    .join('');\n\n  // gallery.innerHTML = '';\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n","'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nlet lightbox;\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0; // Загальна кількість зображень, що відповідають запиту\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst loader = document.querySelector('.loader');\nconst loaderExtra = document.querySelector('.loader-extra');\nconst loadMoreButton = document.querySelector('.load-more'); // Кнопка \"Load more\"\n\n// Ховаємо кнопку \"Load more\" на старті\nloadMoreButton.style.display = 'none';\n\nform.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n\n  currentQuery = input.value.trim();\n  currentPage = 1; // Скидаємо значення сторінки для нового пошуку\n\n  if (!currentQuery) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query...',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  loader.style.display = 'block';\n  loadMoreButton.style.display = 'none'; // Ховаємо кнопку перед завантаженням\n\n  try {\n    const response = await fetchImages(currentQuery, currentPage);\n\n    totalHits = response.totalHits; // Оновлюємо загальну кількість зображень\n\n    loader.style.display = 'none';\n\n    if (response.hits.length === 0) {\n      gallery.innerHTML = '';\n      iziToast.info({\n        title: 'No Results',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 5000,\n      });\n      form.reset();\n      return;\n    }\n\n    gallery.innerHTML = ''; // Очищаємо галерею перед новим пошуком\n    createMarkup(response.hits);\n    lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionSelector: 'img',\n      captionType: 'attr',\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n\n    // Перевірка на кінець колекції\n    const totalPages = Math.ceil(totalHits / 15); // Загальна кількість сторінок\n    if (currentPage >= totalPages) {\n      loadMoreButton.style.display = 'none';\n      iziToast.info({\n        title: 'End of Results',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 5000,\n      });\n    } else {\n      loadMoreButton.style.display = 'block'; // Показуємо кнопку \"Load more\"\n    }\n\n    // Прокрутка сторінки після завантаження нових зображень\n    // scrollPage();\n  } catch (error) {\n    loader.style.display = 'none';\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n    });\n    console.error('Error fetching images:', error);\n  }\n}\n\nasync function loadMoreImages() {\n  currentPage += 1; // Збільшуємо номер сторінки для наступного завантаження\n\n  loaderExtra.style.display = 'block';\n  loadMoreButton.style.display = 'none';\n  try {\n    const response = await fetchImages(currentQuery, currentPage);\n\n    loaderExtra.style.display = 'none';\n\n    if (response.hits.length === 0) {\n      loadMoreButton.style.display = 'none'; // Ховаємо кнопку, якщо більше немає результатів\n      iziToast.info({\n        title: 'No More Results',\n        message: 'No more images available.',\n        position: 'topRight',\n        timeout: 5000,\n      });\n      return;\n    }\n\n    createMarkup(response.hits);\n    scrollPage();\n    // Перевірка на кінець колекції\n    const totalPages = Math.ceil(totalHits / 15); // Загальна кількість сторінок\n    if (currentPage >= totalPages) {\n      // Якщо поточна сторінка остання\n      loadMoreButton.style.display = 'none';\n      iziToast.info({\n        title: 'End of Results',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 5000,\n      });\n    } else {\n      loadMoreButton.style.display = 'block';\n    }\n\n    // Оновлюємо lightbox, якщо він існує\n    if (lightbox) {\n      lightbox.refresh();\n    }\n\n    // Прокрутка сторінки після завантаження нових зображень\n  } catch (error) {\n    loader.style.display = 'none';\n    loadMoreButton.style.display = 'block'; // Показуємо кнопку, щоб користувач міг спробувати знову\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch more images. Please try again later.',\n      position: 'topRight',\n    });\n    console.error('Error fetching more images:', error);\n  }\n}\n\nfunction scrollPage() {\n  const galleryItem = gallery.querySelector('.gallery-item:last-child');\n\n  if (!galleryItem) return;\n\n  const cardHeight = galleryItem.getBoundingClientRect().height; // Висота останньої картки\n\n  console.log(cardHeight); // Перевіряємо висоту картки\n\n  // Прокручуємо на дві висоти картки\n  window.scrollBy({\n    top: cardHeight * 2, // Прокрутка на дві висоти картки\n    behavior: 'smooth', // Плавна прокрутка\n  });\n}\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","searchParams","url","axios","error","gallery","createMarkup","arrImages","markup","image","lightbox","currentQuery","currentPage","totalHits","form","input","loader","loaderExtra","loadMoreButton","handleSubmit","loadMoreImages","event","iziToast","response","SimpleLightbox","totalPages","scrollPage","galleryItem","cardHeight"],"mappings":"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"}